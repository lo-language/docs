/**
 */

main is <-> (args, io, node) {

    lo      is "http://lolang.org";
    apple   is "http://www.apple.com";
    google  is "http://www.google.com";


    // todo connect authority with expertise

    sendRequest is <-> {

        @node.http.request(url) -> (res, body) {

            // this style constrains param names to this handler scope

            @io.out.write("response from `url`: status = `res.statusCode`\n");
            @io.out.write("body length: `#body`\n");

            reply #body;
        }
        on fail -> (err) {

        };

        @io.out.write("sent request to `url`\n");
    };

    // race some requests

    req1Len = @sendRequest(google); // req1Len is a future now
    req2Len = sendRequest(apple);

    @io.out.write("`req1Len`\n");

    req3Len = @sendRequest(exa);
};